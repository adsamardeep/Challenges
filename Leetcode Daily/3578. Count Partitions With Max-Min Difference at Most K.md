class Solution:             # Time = O(n) = Space
    def countPartitions(self, nums: List[int], k):
        left, cnt, mod = 0, 1, 1000000007
        mnQ, mxQ, dp = deque(), deque(), [cnt]
        for rght, num in enumerate(nums):
            while mxQ and num > mxQ[-1]: mxQ.pop()
            while mnQ and num < mnQ[-1]: mnQ.pop()
            mxQ.append(num) ; mnQ.append(num)
            while mxQ[0] - mnQ[0] > k:
                if nums[left] == mxQ[0]: mxQ.popleft()
                if nums[left] == mnQ[0]: mnQ.popleft()
                cnt -= dp[left] ; left += 1
            dp.append(cnt) ; cnt = (cnt * 2) % mod
        return dp[-1] % mod