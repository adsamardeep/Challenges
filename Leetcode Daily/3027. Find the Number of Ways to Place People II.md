from typing import List

class Solution:
    def numberOfPairs(self, points: List[List[int]]) -> int:
        n = len(points)
        cnt = 0
        points.sort()  # sort by x then y

        mpx, mpy = {}, {}
        for x, y in points:
            mpx[x] = mpx.get(x, 0) + 1
            mpy[y] = mpy.get(y, 0) + 1

        for i in range(n):
            for j in range(i + 1, n):
                p1, p2 = points[i], points[j]

                if p1[0] < p2[0] and p1[1] < p2[1]:
                    continue
                if p1[0] == p2[0] or p1[1] == p2[1]:
                    continue

                check = True
                for k in range(n):
                    if k == i or k == j:
                        continue
                    px, py = points[k]
                    if px >= p1[0] and px <= p2[0] and py >= p2[1] and py <= p1[1]:
                        check = False
                        break
                if check:
                    cnt += 1

        for val in mpx.values():
            cnt += val - 1
        for val in mpy.values():
            cnt += val - 1

        return cnt