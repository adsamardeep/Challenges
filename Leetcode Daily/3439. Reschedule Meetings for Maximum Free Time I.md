class Solution:
    def maxFreeTime(self, eventTime, k, startTime, endTime):
        n = len(startTime)
        gaps = [0] * (n + 1)
        gaps[0] = startTime[0]
        gaps[n] = eventTime - endTime[-1]

        for i in range(1, n):
            gaps[i] = startTime[i] - endTime[i - 1]

        prefix = [0] * (n + 2)
        for i in range(1, n + 2):
            prefix[i] = prefix[i - 1] + gaps[i - 1]

        max_free = 0
        for i in range(k + 1, n + 2):
            max_free = max(max_free, prefix[i] - prefix[i - (k + 1)])

        return max_free