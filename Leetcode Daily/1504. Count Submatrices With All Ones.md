# üü© Problem: Count Submatrices With All Ones

## üìú Problem Statement
Given a binary matrix `mat` of size `r √ó c`, return the **number of submatrices** that contain **only 1‚Äôs**.

---

## üîç Example 1
**Input**
```python
mat = [
  [1,0,1],
  [1,1,0],
  [1,1,0]
]
```

**Explanation**
- Total valid submatrices = **13**

**Output**
```
13
```

---

## üîç Example 2
**Input**
```python
mat = [
  [0,1,1,0],
  [0,1,1,1],
  [1,1,1,0]
]
```

**Output**
```
24
```

---

## üß† Approach
We extend the **Largest Rectangle in Histogram** technique row by row.

1. Treat each row as the **base of a histogram**, where `h[j]` represents the height of consecutive `1`s at column `j`.
   - If `mat[i][j] == 1` ‚Üí `h[j] += 1`
   - Else ‚Üí `h[j] = 0`

2. For each row:
   - Use a **monotonic increasing stack** to efficiently count the number of submatrices ending at row `i` for every column `j`.
   - Maintain `sumv[j]` which stores the number of valid submatrices ending at column `j`.

3. Accumulate all counts into `ans`.

---

## üíª Code Implementation
```python
from typing import List

class Solution:
    def numSubmat(self, mat: List[List[int]]) -> int:
        r, c = len(mat), len(mat[0])
        h = [0] * c
        ans = 0

        for i in range(r):
            # Build histogram heights
            for j in range(c):
                h[j] = h[j] + 1 if mat[i][j] else 0

            sumv, st = [0] * c, []
            for j in range(c):
                while st and h[st[-1]] >= h[j]:
                    st.pop()
                if st:
                    p = st[-1]
                    sumv[j] = sumv[p] + h[j] * (j - p)
                else:
                    sumv[j] = h[j] * (j + 1)
                st.append(j)
                ans += sumv[j]

        return ans
```

---

## ‚è± Complexity Analysis
- **Time Complexity:** O(r √ó c)  
  Each element is processed at most once per row (thanks to stack).  
- **Space Complexity:** O(c)  
  For storing histogram heights, monotonic stack, and partial sums.

---

## üß™ Edge Cases
- Matrix with all `0`s ‚Üí result = 0  
- Matrix with all `1`s ‚Üí result = total number of possible submatrices  
- Single row or single column matrix (reduces to histogram problem)  
